{% extends('@FrontEnd/adminBase.html.twig') %}

{% block title %}Rollerei Brettliebe Admin - Videos{% endblock %}

{% block styles %}
    <link href="{{ asset('bundles/frontend/css/admin/controls.css') }}" rel="stylesheet"/>
<style>
    .sub-root{
        width:                              100%;

        display:                            flex;
        flex-flow:                          row nowrap;

    }
    .video-list{
        flex-grow:                          1;

        display:                            flex;
        flex-flow:                          row wrap;

        padding-left:                       50px;
        padding-top:                        30px;
    }
    .video{
        min-width:                          300px;
        width:                              auto;

        display:                            flex;
        flex-flow:                          column nowrap;

        margin-right:                       20px;
        margin-bottom:                      20px;
    }
    .panel-heading .form-group{
        margin: 0;
    }
    .video-label-list{
        width:                              auto;
        flex-grow:                          1;

        display:                            flex;
        flex-flow:                          column nowrap;

    }
    .video-label{
        width:                              auto;
        min-width:                          40px;
        max-height:                         40px;

        color:                              #000;
        font-size:                          18px;
        font-style:                         normal;
        font-family:                        Arial, sans-serif;
        font-stretch:                       semi-expanded;
        text-align:                         center;
        text-decoration:                    none;

        padding:                            10px 0;
    }
    .video-name{

    }
    .video-url{

    }
    .video-created{

     }
    .video-player-container{
        flex-grow:                          1;

    }
    .video-loader{
        width: 100%;


        display:                            flex;
        flex-flow:                          row nowrap;
        justify-content:                    center;
        align-items:                        center;
    }
    .video-loader-text{
        flex-grow:                           1;
    }
    .loading-animation{
        width:                                  20px;
        height:                                 100%;
    }
    .video-loader.loading{
        background:                             var(--base-disabled-background-text);
    }
    .video-loader.loading .loading-animation{
        background: red;
    }
    .form-container{
        background:                         var(--base-background-text);

        border:                             3px solid #000;
        border-radius:                      10px;

        position:                           fixed;
        z-index:                            100;
        top:                                100px;
        left:                               100px;
    }
    .form-header{
        width:                              100%;
        flex-grow:                          1;

        display:                            flex;
        flex-flow:                          row nowrap;
    }
    .form-title{
        flex-grow:                          1;
    }
    .form-close{
        width:                              20px;
        height:                             20px;
    }
    .create-video-form{

        display:                            flex;
        flex-flow:                          column nowrap;

        padding:                            20px;

    }
</style>
{%  endblock %}

{% block scripts %}
    <script src="{{ asset('bundles/frontend/js/Repository.js') }}"></script>
    <script src="{{ asset('bundles/frontend/js/VideoApiController.js') }}"></script>
<script>
    var app = angular.module("AdminAllVideos",['Repository']);
    app.controller('AllVideosEdit',['VideoRepo','PlatformRepo',function (Videos, Platforms) {
        var self = this;

        self.Videos = Videos;
        self.Platforms = Platforms;

        self.isFormVisible = false;
        self.showForm = function(){ self.isFormVisible=true; };
        self.closeForm = function(){ self.isFormVisible=false; };

    }]);
    app.controller('VideoForm',['VideoRepo','PlatformRepo',function (Videos,Platforms) {
        var self = this;
        self.name = "";
        self.url = "";
        self.created = null;
        self.platform = null;

        self.Videos = Videos;
        self.Platforms = Platforms;

        self.create = function () {
            var dto = { name: self.name, url: self.url, created: self.created, platform: self.platform.id};
            console.log(dto);
           self.Videos.create(dto);
        };
    }]);
    app.config(function($interpolateProvider){
        $interpolateProvider.startSymbol('{[{').endSymbol('}]}');
    });
</script>
{%  endblock %}


{% block headerContent %}

{%  endblock %}

{% block mainContent %}
    <div class="sub-root" ng-app="AdminAllVideos" ng-controller="AllVideosEdit as videosCtrl">
        <div class="container-fluid">
            <button class="btn btn-large btn-default center-block show-form" ng-click="videosCtrl.showForm()">
                <span>New</span>
                <span class="glyphicon glyphicon-plus"></span>
            </button>
        </div>
        <div class="video-list">
            <form class="video panel panel-default" ng-repeat="video in videosCtrl.Videos.all">
                <div class="panel-heading">
                    <fieldset class="form-group">
                        <label class="sr-only" for="{[{ 'video-name-'+video.id }]}">Name</label>
                        <input class="video-name panel-title" ng-model="video.name" id="{[{ 'video-name-'+video.id }]}"
                               placeholder="Name"/>
                    </fieldset>
                </div>
                <div class="panel-body">
                    <div class="video-label-list">
                        <fieldset class="form-group">
                            <label for="{[{ 'video-url-'+video.id }]}">URL</label>
                            <input class="video-url" ng-model="video.url" id="{[{ 'video-url-'+video.id }]}" placeholder="URL"/>
                        </fieldset>
                        <fieldset class="form-group">
                            <label for="{[{ 'video-created-'+video.id }]}">Erstellt</label>
                            <input class="video-created" ng-model="video.created" id="{[{ 'video-created-'+video.id }]}"
                                   placeholder="Erstellt"/>
                        </fieldset>
                        <fieldset class="form-group">
                            <label for="{[{ 'video-platform-'+video.id }]}">Platform</label>
                            <select ng-model="video.platform" id="{[{ 'video-platform-'+video.id }]}"
                                    ng-options="platform.name for platform in videosCtrl.Platforms.all">
                                <option value="">Wähle eine Platform Aus</option>
                            </select>
                        </fieldset>
                    </div>
                    <div class="video-player-container">
                    </div>
                    <button class="btn-btn-default video-loader">
                        <span class="video-loader-text">Load</span>
                        <span class="loading-animation"></span>
                    </button>
                </div>
                <div class="panel-footer">
                    <button type="button" class="btn btn-large btn-success">
                        <span>Speichern</span>
                        <span class="glyphicon glyphicon-upload" aria-hidden="true"></span>
                    </button>
                    <button type="button" class="btn btn-large btn-danger">
                        <span>Verwerfen</span>
                        <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
                    </button>
                </div>
            </form>
        </div>
        <div class="form-container" ng-show="videosCtrl.isFormVisible" ng-controller="VideoForm as videoForm">
            <div class="form-header">
                <span class="label form-title">Neues Video</span>
                <span class="button form-close" ng-click="videosCtrl.closeForm()">X</span>
            </div>
            <form class="create-video-form">
                <fieldset class="field">
                    <label class="label" for="video-form-name">Name:</label>
                    <input class="text-input" ng-model="videoForm.name" name="name" id="video-form-name"/>
                </fieldset>
                <fieldset class="field">
                    <label class="label" for="video-form-url">Url:</label>
                    <input class="text-input" ng-model="videoForm.url" name="url" id="video-form-url"/>
                </fieldset>
                <fieldset class="field">
                    <label class="label" for="video-form-created">Erstellt:</label>
                    <input class="text-input" ng-model="videoForm.created" name="created" id="video-form-created"/>
                </fieldset>
                <fieldset class="field">
                    <label class="label" for="video-form-platform">Platform:</label>
                    <select ng-model="videoForm.platform" ng-options="platform.name for platform in videoForm.Platforms.all"
                        id="video-form-platform">
                        <option value="">Wähle eine Platform Aus</option>
                    </select>
                </fieldset>
                <span class="create-video button" ng-click="videoForm.create()">Erstellen</span>
            </form>
        </div>
    </div>
{% endblock %}

{% block footerContent %}

{%  endblock %}